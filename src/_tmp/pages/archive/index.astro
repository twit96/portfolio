---
import PostCollectionLayout from '@layouts/PostCollectionLayout.astro';
import ArchiveCategories from '@components/ArchiveCategories.astro';
import { getCollection } from 'astro:content';

let posts = (await getCollection('posts')).filter(post => !post.data.draft);
posts.sort(function(a, b) {
	let a_date = Date.parse(a.data.dateUpdated || a.data.datePublished);
  let b_date = Date.parse(b.data.dateUpdated || b.data.datePublished);
  if (b_date > a_date) return 1;
  if (a_date > b_date) return -1;
  return 0;
});
---
<PostCollectionLayout
	title="Archive"
	posts={posts}
>
  <ArchiveCategories />
</PostCollectionLayout>
